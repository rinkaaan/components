{"version":3,"file":"type-utils.js","sourceRoot":"","sources":["../../src/shared/type-utils.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport ts from 'typescript';\n\nexport function isOptional(type: ts.Type) {\n  if (!type.isUnionOrIntersection()) {\n    return false;\n  }\n  return !!type.types.find(t => t.flags & ts.TypeFlags.Undefined);\n}\n\nexport function isNullable(type: ts.Type) {\n  if (!type.isUnionOrIntersection()) {\n    return false;\n  }\n  return !!type.types.find(t => t.flags & ts.TypeFlags.Null);\n}\n\nexport function unwrapNamespaceDeclaration(declaration: ts.Declaration | undefined) {\n  if (!declaration) {\n    return [];\n  }\n  const namespaceBlock = declaration.getChildren().find(node => node.kind === ts.SyntaxKind.ModuleBlock);\n  if (!namespaceBlock) {\n    return [];\n  }\n  const moduleContent = namespaceBlock.getChildren().find(node => node.kind === ts.SyntaxKind.SyntaxList);\n  if (!moduleContent) {\n    return [];\n  }\n  return moduleContent.getChildren();\n}\n\nfunction stripUndefined(typeString: string) {\n  return typeString.replace(/\\| undefined$/, '').trim();\n}\n\nexport function stringifyType(type: ts.Type, checker: ts.TypeChecker) {\n  return stripUndefined(\n    checker.typeToString(\n      type,\n      undefined,\n      ts.TypeFormatFlags.WriteArrayAsGenericType |\n        ts.TypeFormatFlags.UseFullyQualifiedType |\n        ts.TypeFormatFlags.UseAliasDefinedOutsideCurrentScope,\n    ),\n  );\n}\n\nfunction expandTags(extraTags: ReadonlyArray<ts.JSDocTag>) {\n  return extraTags.map(tag => ({\n    name: tag.tagName.text,\n    text: ts.getTextOfJSDocComment(tag.comment),\n  }));\n}\n\nexport function getDescription(docComment: Array<ts.SymbolDisplayPart>, declaration: ts.Node) {\n  return {\n    text: docComment.length > 0 ? ts.displayPartsToString(docComment) : undefined,\n    tags: expandTags(ts.getJSDocTags(declaration)),\n  };\n}\n\nexport function extractDeclaration(symbol: ts.Symbol) {\n  const declarations = symbol.getDeclarations();\n  if (!declarations || declarations.length === 0) {\n    throw new Error(`No declaration found for symbol: ${symbol.getName()}`);\n  }\n  if (declarations.length > 1) {\n    throw new Error(`Multiple declarations found for symbol: ${symbol.getName()}`);\n  }\n  return declarations[0];\n}\n\nexport function printFlags(flags: number, mapping: Record<string, number | string>) {\n  return Object.entries(mapping)\n    .filter(([, value]) => typeof value === 'number')\n    .filter(([, value]) => (value as number) & flags)\n    .map(([key]) => key);\n}\n\nexport function extractTypeArguments(type: ts.Type, checker: ts.TypeChecker) {\n  const typeParameters = checker.getTypeArguments(type as ts.TypeReference);\n\n  if (typeParameters.length <= 0) {\n    return { typeName: stringifyType(type, checker) };\n  }\n  const symbol = type.getSymbol();\n  if (!symbol) {\n    throw new Error(`Unknown generic type without symbol: ${stringifyType(type, checker)}`);\n  }\n  return { typeParameters, typeName: checker.symbolToString(symbol) };\n}\n"]}