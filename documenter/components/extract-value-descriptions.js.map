{"version":3,"file":"extract-value-descriptions.js","sourceRoot":"","sources":["../../src/components/extract-value-descriptions.ts"],"names":[],"mappings":";;;;;AAMA,4DAwCC;AA9CD,qEAAqE;AACrE,sCAAsC;AACtC,4DAA4B;AAC5B,qDAA0D;AAG1D,SAAgB,wBAAwB,CAAC,IAAgC,EAAE,QAAiC;;IAC1G,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;QACrB,uEAAuE;QACvE,MAAM,gBAAgB,GAAG,IAAA,+BAAkB,EAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAC9D,IAAI,oBAAE,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,EAAE,CAAC;YAChD,QAAQ,GAAG,gBAAgB,CAAC,IAAI,CAAC;QACnC,CAAC;IACH,CAAC;IAED,IAAI,CAAC,QAAQ,EAAE,CAAC;QACd,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,MAAM,SAAS,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;IAC5C,mCAAmC;IACnC,6HAA6H;IAC7H,IAAI,SAAS,CAAC,IAAI,KAAK,oBAAE,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;QAChD,OAAO,EAAE,CAAC;IACZ,CAAC;IACD,MAAM,WAAW,GAA8B,EAAE,CAAC;IAClD,IAAI,WAAW,GAAG,CAAC,CAAC;IACpB,KAAK,MAAM,KAAK,IAAI,SAAS,CAAC,WAAW,EAAE,EAAE,CAAC;QAC5C,MAAM,IAAI,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;QACjC,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC;YACzB,WAAW,CAAC,WAAW,CAAC,GAAG,CAAC,MAAA,WAAW,CAAC,WAAW,CAAC,mCAAI,EAAE,CAAC,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;QACpF,CAAC;QAED,IAAI,KAAK,CAAC,IAAI,KAAK,oBAAE,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;YAC1C,WAAW,EAAE,CAAC;QAChB,CAAC;IACH,CAAC;IACD,iCAAiC;IACjC,uHAAuH;IACvH,OAAO,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,EAAgC,EAAE;QAC3E,IAAI,CAAC,OAAO,EAAE,CAAC;YACb,OAAO,SAAS,CAAC;QACnB,CAAC;QACD,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC;QACjG,OAAO,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;IAC5D,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport ts from 'typescript';\nimport { extractDeclaration } from '../shared/type-utils';\nimport { ValueDescription } from './interfaces';\n\nexport function extractValueDescriptions(type: ts.UnionOrIntersectionType, typeNode: ts.TypeNode | undefined) {\n  if (type.aliasSymbol) {\n    // Traverse from \"variant: ButtonProps.Variant\" to \"type Variant = ...\"\n    const aliasDeclaration = extractDeclaration(type.aliasSymbol);\n    if (ts.isTypeAliasDeclaration(aliasDeclaration)) {\n      typeNode = aliasDeclaration.type;\n    }\n  }\n\n  if (!typeNode) {\n    return [];\n  }\n\n  const maybeList = typeNode.getChildren()[0];\n  // based on similar code in typedoc\n  // https://github.com/TypeStrong/typedoc/blob/6090b3e31471cea3728db1b03888bca5703b437e/src/lib/converter/symbols.ts#L406-L438\n  if (maybeList.kind !== ts.SyntaxKind.SyntaxList) {\n    return [];\n  }\n  const rawComments: Array<string | undefined> = [];\n  let memberIndex = 0;\n  for (const child of maybeList.getChildren()) {\n    const text = child.getFullText();\n    if (text.includes('/**')) {\n      rawComments[memberIndex] = (rawComments[memberIndex] ?? '') + child.getFullText();\n    }\n\n    if (child.kind !== ts.SyntaxKind.BarToken) {\n      memberIndex++;\n    }\n  }\n  // Array.from to fix sparse array\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#array_methods_and_empty_slots\n  return Array.from(rawComments).map((comment): ValueDescription | undefined => {\n    if (!comment) {\n      return undefined;\n    }\n    const systemTags = Array.from(comment.matchAll(/@awsuiSystem\\s+(\\w+)/g), ([, system]) => system);\n    return systemTags.length > 0 ? { systemTags } : undefined;\n  });\n}\n"]}